# For the win. Rogue-like game

# Описание геймплея и ключевых идей

Игрок передвигается по двухмерной карте, населенной врагами и по которой разбросаны предметы. Игрок собирает предметы, 
тем самым повышает свои характеристики и эффективнее сражается с врагами. Враги постоянно появляются в случайных точках карты.

На карте есть порталы, которые позволяют перейти на другую карту. 
Следующая карта будет населена более сильными врагами, но и с более сильными предметами. Назад пройти нельзя.

Одной из особенностей игры являются фабрики предметов и мобов. Внешний вид предметов и мобов и их характеристики 
генерируются в начале игры, и не сохраняются между перезапусками (но сохраняются в рамках одной сессии). 
То есть, перед началом игры игрок не знает какими характеристиками обладают конкретные элементы на карте. Ему необходимо
с ними повзаимодействовать, чтобы узнать их свойства. При этом свойства предметов станут сразу очевидными, а вот о свойствах
мобов можно будет только предполагать.

Цель игры - пройти как можно большее количество карт.

# Термины и определения

### Сессия (Session)
Процесс игры с первого уровня до смерти (достижения нулевого уровня здоровья) главного персонажа.

### Уровень (Stage)
Уровень определяет карту, противников и их характеристики, награды, которые могут быть обнаружены на карте.

### Карта (Map)
Двумерный массив, на котором зафиксированы положения объектов (стен, проходов на другие карты).   
Карты генерируются автоматически или подгружаются из файла.

## Юнит (Unit)
Объект игры, который обладает поведением и состоянием (игрок и мобы)

## Предмет (Item)
Объект игры, которые не обладает поведением, но влияет на характеристики игрока

## Характеристики юнита:
1. **Здоровье** (HP)
* Максимальное здоровье  
* Текущее здоровье. Сохраняется при переходе на следующий уровень
* Множитель здоровья. Регенерация (как быстро восстанавливается здоровье)

2. **Опыт** (XP)
* Текущий опыт
* Множитель опыта

3. **Уровень** (Level) - Влияет на другие характеристики игрока
* Текущий уровень. 

4. **Урон** (Damage) - Диапазон значений в рамках которых наносится урон пративнику.
* Минимальный урон 
* Максимальный урон. 

5. **Защита** (Defence) - Сравнивается с атакой. Результат - множитель, учитываемый при подсчете реального урона.
* Текущая защита

6. **Атака** (Attack ) - Сравнивается с защитой. Результат - множитель, учитываемый при подсчете реального урона.
* Текущая атака

7. **Скорость** - Скорость перемещения юнита по карте
* Текущая скорость
* Множитель скорости

8. **Энергия** (Energy) - Множитель для реального урона и скорости.
* Фактический уровень
* Максимальный уровень
* Множитель энергии (как быстро она восстанавливается) 

## Противники (Mobs)

Фабрика противников при старте сессии генерирует несколько видов (Kinds) мобов. 
Они различаются по Стратегии поведения (Strategy), внешнему виду (символу) и характеристикам.
Например, генератор сгенерировал моба "A", который обладает значительным здоровьем и защитой,
но малой скоростью и параметрами атаки.

При старте уровня фабрика адаптирует конкретные значения параметров моба под текущий уровень и отдает их игровому движку.
Таким образом игрок может путем проб и ошибок узнать какие мобы опасные, а какие не очень. И это знание с ним сохранится
до конца сессии. Но при начале новой сессии все поменяется.

Мобы обладают уникальной стратегией (Strategy), которая определяет вид поведения - агрессивное, пассивное и трусливое.

## Предметы (Items)

Фабрика предметов при старте сессии генерирует несколько видов (Kinds) предметов.
Они различаются по характеристки на которую предмет влияет и внешнему виду (символу).
Например, генератор сгенерировал предмет "#", который повышает минимальный урон.

При старте уровня фабрика адаптирует конкретные значения параметров предмета под текущий уровень и отдает их игровому движку.

## Judge
Получает юнита, его следующее действие и карту и определяет как фактически измениться его состояние.
Если произошел контакт между игроком и мобом, то Judge консультируется c Боевой системой и изменяет текущее здоровье 
у игрока и моба.

# Технические детали
## Технологии
Игра будет написана на Java 17, собираться с помощью Maven. Библиотека для отрисовки терминала - Lanterna

## Меню
Приветственное окно с названием игры, приглашает игрока к игре. При нажатии любой клавиши начинается игра.

## Основная логика игры
1. Отображение меню
2. Инициализация игры:  
   2.1. Создание игрока  
   2.2. Генерация типов мобов и типов предметов
3. Цикл по комнатам:  
   3.1. Сгенерировать комнату  
   3.2. Поместить игрока на карту  
   3.3. Инициализировать Judge и Timeline  
   3.4. Запускаем цикл игры
4. Цикл игры:  
   4.1. Запросить у timeline список юнитов, которые должны сделать действия к текущему моменту времени. 
Юнит добавляется в список ровно столько раз, столько действий он успел сделать.  
   4.2. Для каждого элемента из списка определяем с помощью Judge, как действие юнита будет отражено на карте. Обновляем карту.   
   4.3. Отрисовываем карту с обновленным состоянием.  

## Диаграммы компонентов и классов

![](/img/component_diagram.jpg)


![](/img/class_diagramm.jpg)